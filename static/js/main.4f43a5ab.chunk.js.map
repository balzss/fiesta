{"version":3,"sources":["utils/data_storage_utils.js","utils/webRTC_utils.js","components/Host.js","components/ChatBubble.js","components/UserList.js","components/Chat.js","components/Player.js","components/ChangeVideo.js","components/Party.js","components/Router.js","serviceWorker.js","index.js"],"names":["store_data","key","data","localStorage","setItem","btoa","JSON","stringify","encode_base64","update_data","data_key","value","get_data","getItem","parse","atob","decode_base64","createConnection","is_host","host_id","previous_id","Promise","resolve","reject","peer_js_url","process","REACT_APP_PEERJS","turn_url","REACT_APP_TURN","turn_username","REACT_APP_TURN_USERNAME","turn_credentials","REACT_APP_TURN_CREDENTIALS","Peer","window","settings","debug","config","iceServers","urls","host","port","path","push","username","credential","peer","peer_obj","handle_connection","connect","on","id","peer_id","conn","console","log","global_this_obj","notify","peer_ids","data_type","chat_handler","connect_to_peer","state","youtube_video_id","setState","videoId","youtube_current_pos","Math","ceil","startSeconds","player_state","event","isStateChangeFromBroadcastData","player","yt_player","seekTo","pauseVideo","user_name","playVideo","setPlaybackRate","playbackRate","setTimeout","handle_youtube","connected_users","color_code","sync_video","send_data","user_list","only_host_controls","handle_intro","handle_intro_init","change_video","video_id","data_handler","left_user_name","connections","msg","i","length","send","broadcast_new_connection","chat_data","chat_log","message","decodeURIComponent","escape","send_chat","msg_json","user_type","unescape","encodeURIComponent","time_stamp","Date","now","generate_chat_structure","payload_data","fetch_current_video_status","yt_event","getPlayerState","getVideoData","getCurrentTime","getPlaybackRate","introduce","broadcast","loadVideoById","format","parseIdFromURL","url","match","Host","host_peer_id","submitted","handleSubmit","e","preventDefault","target","youtubeLink","userName","onlyHost","checked","then","peerId","this","to","pathname","className","onSubmit","placeholder","type","name","required","React","Component","ChatBubble","style","color","props","UserList","connectedUsers","Object","entries","map","userInfo","Chat","add_text","send_message","chatBottom","createRef","current","scrollIntoView","behavior","index","ref","onChange","fontSize","alignItems","height","Player","loadScript","YT","loadVideo","tag","document","createElement","src","onYouTubeIframeAPIReady","firstScriptTag","getElementsByTagName","parentNode","insertBefore","playerHeight","round","innerHeight","playerWidth","width","playerVars","start","events","onReady","onPlayerReady","onStateChange","onPlayerStateChange","onPlaybackRateChange","onPlayerPlaybackRateChange","PlayerState","PLAYING","PAUSED","ChangeVideo","changeVideo","video_url","getRandomTagColor","bulmaTagColors","floor","random","Party","invite_popup_shown","setUserName","copyToClipboard","copy_invite","select","execCommand","closeModal","timeout","toast","info","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","toastId","params","reconnect_users","host_data","wait_time","bulk_connect","keys","newestOnTop","rtl","pauseOnFocusLoss","aria-label","onClick","location","href","readOnly","role","Router","exact","component","Boolean","hostname","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.4f43a5ab.chunk.js","sourcesContent":["export function encode_base64(data) {\n  return btoa(JSON.stringify(data));\n}\n\nexport function decode_base64(data) {\n  return JSON.parse(atob(data));\n}\n\nexport function store_data(key, data) {\n  localStorage.setItem(key, encode_base64(data));\n}\n\nexport function update_data(data_key, key, value) {\n  var data = get_data(data_key);\n  if (!data) {\n    return false;\n  }\n  data[key] = value;\n  store_data(data_key, data);\n}\n\nexport function get_data(key) {\n  var data = localStorage.getItem(key);\n  if (data) {\n    return decode_base64(data);\n  }\n  return false;\n}\n","import { update_data } from \"./data_storage_utils\";\n\nexport var global_this_obj = null;\n\nexport const createConnection = (is_host, host_id = null, previous_id = null) =>\n  new Promise((resolve, reject) => {\n    let peer_js_url = process.env.REACT_APP_PEERJS;\n    let turn_url = process.env.REACT_APP_TURN;\n    let turn_username = process.env.REACT_APP_TURN_USERNAME;\n    let turn_credentials = process.env.REACT_APP_TURN_CREDENTIALS;\n    const Peer = window.Peer;\n    const settings = {\n      debug: 2,\n      // iceTransportPolicy: \"relay\",\n      config: {\n        iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }]\n      }\n    };\n    if (peer_js_url) {\n      settings.host = peer_js_url;\n      settings.port = \"\";\n      settings.path = \"/myapp\";\n    }\n    if (turn_url) {\n      settings.config.iceServers.push({\n        urls: turn_url,\n        username: turn_username,\n        credential: turn_credentials\n      });\n    }\n\n    if (previous_id) {\n      var peer = new Peer(previous_id, settings);\n    } else {\n      var peer = new Peer(settings);\n    }\n\n    window.peer_obj = peer;\n    window.is_host = is_host;\n    if (is_host !== true) {\n      var conn = peer.connect(host_id);\n      handle_connection(conn);\n    }\n\n    peer.on(\"open\", function(id) {\n      window.peer_id = peer.id;\n      resolve(peer.id, window.is_host);\n    });\n\n    //   Initializes connection\n    peer.on(\"connection\", function(conn) {\n      console.log(\"connection called\");\n      handle_connection(conn);\n    });\n\n    peer.on(\"close\", function() {\n      console.log(\"peer closed\");\n      window.global_this_obj.notify(\"Network disconnected please refresh\", 10000);\n    });\n\n    peer.on(\"disconnected\", function() {\n      console.log(\"peer disconnected\");\n      // peer.reconnect();\n      window.global_this_obj.notify(\"Network disconnected please refresh\", 10000);\n    });\n  });\n\nfunction handle_connection(conn) {\n  window.peer_ids.push(conn.peer);\n\n  conn.on(\"data\", function(data) {\n    console.log(\"data received\");\n    console.log(data);\n    data_handler(data);\n  });\n\n  conn.on(\"close\", function() {\n    var connected_users = window.global_this_obj.state.connected_users;\n    if (!connected_users || !connected_users[conn.peer]) {\n      return;\n    }\n    const left_user_name = connected_users[conn.peer].user_name;\n    delete connected_users[conn.peer];\n    window.global_this_obj.setState({ connected_users: connected_users });\n    window.global_this_obj.notify(`${left_user_name} has left the party`);\n    if (window.is_host) {\n      update_data(window.peer_obj.id, \"connected_users\", connected_users);\n    }\n  });\n\n  window.connections.push(conn);\n\n  if (window.is_host === true) {\n    broadcast_new_connection(conn.peer);\n  }\n}\n\nfunction data_handler(data) {\n  if (typeof data === \"object\" && data !== null) {\n    if (data.data_type === \"chat\") {\n      chat_handler(data);\n    } else if (data.data_type === \"new_connection\") {\n      connect_to_peer(data.peer_id);\n    } else if (data.data_type === \"youtube\") {\n      handle_youtube(data);\n    } else if (data.data_type === \"intro\") {\n      handle_intro(data);\n    } else if (data.data_type === \"user_list\") {\n      handle_intro_init(data);\n    } else if (data.data_type === \"change_video\") {\n      change_video(data.video_id);\n    }\n  }\n}\n\nfunction send_data(data) {\n  console.log(\"Sending data: \");\n  console.log(data);\n  var connections = window.connections;\n  for (var i = 0; i < connections.length; i++) {\n    connections[i].send(data);\n  }\n}\n\nfunction broadcast_new_connection(peer_id) {\n  var msg = { data_type: \"new_connection\", peer_id: peer_id };\n  for (var i = 0; i < window.connections.length; i++) {\n    if (window.connections[i].peer === peer_id) {\n      continue;\n    }\n    window.connections[i].send(msg);\n  }\n}\n\nfunction connect_to_peer(peer_id) {\n  var conn = window.peer_obj.connect(peer_id);\n  handle_connection(conn);\n}\n\nexport function bulk_connect(peer_ids, host_data) {\n  for (let id in peer_ids) {\n    setTimeout(function() {\n      connect_to_peer(peer_ids[id]);\n    }, 250);\n  }\n  const wait_time = 250 * peer_ids.length + 100;\n  setTimeout(function() {\n    console.log(\"intro called\");\n    introduce(host_data.user_name, host_data.color_code);\n  }, wait_time);\n}\n// Chat utils\nfunction chat_handler(chat_data) {\n  var chat_log = window.global_this_obj.state.chat_log;\n  chat_data.message = decodeURIComponent(\n    escape(window.atob(chat_data.message))\n  );\n\n  chat_log.push(chat_data);\n  window.global_this_obj.setState({\n    chat_log: chat_log\n  });\n}\n\nexport function send_chat(msg, user_name, is_host, color_code) {\n  var msg_json = generate_chat_structure(msg, user_name, is_host, color_code);\n  send_data(msg_json);\n  chat_handler(msg_json);\n}\n\nfunction generate_chat_structure(msg, user_name, is_host, color_code) {\n  var format = {\n    data_type: \"chat\",\n    user_name: user_name,\n    user_type: is_host ? \"Host\" : \"Client\",\n    message: btoa(unescape(encodeURIComponent(msg))),\n    color_code: color_code,\n    time_stamp: Date.now()\n  };\n  return format;\n}\n\n//  Youtube utils\n\nfunction handle_youtube(data) {\n  var state = window.global_this_obj.state;\n  if (state.youtube_video_id === \"\") {\n    window.global_this_obj.setState({\n      youtube_video_id: data.videoId,\n      youtube_current_pos: Math.ceil(data.startSeconds),\n      player_state: data.event\n    });\n  } else {\n    window.global_this_obj.setState({ isStateChangeFromBroadcastData: true });\n    const player = window.yt_player;\n\n    if (data.event === 2) {\n      // isStateChangeFromBroadcastData = true;\n      player.seekTo(data.startSeconds, true);\n      player.pauseVideo();\n      window.global_this_obj.notify(`${data.user_name} paused the video`);\n    } else if (data.event === 1) {\n      // isStateChangeFromBroadcastData = true;\n      player.seekTo(Math.ceil(data.startSeconds), true);\n      player.playVideo();\n      window.global_this_obj.notify(`${data.user_name} started the video`);\n    } else if (data.event === 3) {\n      // isStateChangeFromBroadcastData = true;\n      player.seekTo(data.startSeconds, true);\n      player.pauseVideo();\n      window.global_this_obj.notify(`${data.user_name} is buffering`);\n    } else if (data.event === \"playbackRateChange\") {\n      player.seekTo(data.startSeconds, true);\n      player.setPlaybackRate(data.playbackRate);\n      window.global_this_obj.notify(\n        `${data.user_name} changed the playback rate to ${data.playbackRate}x`\n      );\n    }\n    setTimeout(function() {\n      window.global_this_obj.setState({\n        isStateChangeFromBroadcastData: false\n      });\n    }, 2500);\n  }\n}\n\nexport function sync_video(event = null) {\n  if (\n    window.global_this_obj.state.only_host_controls === true &&\n    window.is_host !== true\n  ) {\n    return;\n  }\n  if (window.global_this_obj.state.isStateChangeFromBroadcastData) {\n    return;\n  }\n  var payload_data = fetch_current_video_status(event);\n  send_data(payload_data);\n}\n\nfunction fetch_current_video_status(event) {\n  var yt_event;\n  const player = window.yt_player;\n  if (event !== null) {\n    yt_event = event;\n  } else {\n    yt_event = player.getPlayerState();\n  }\n\n  var videoId = player.getVideoData()[\"video_id\"];\n  var startSeconds = player.getCurrentTime();\n  var playbackRate = player.getPlaybackRate();\n\n  var payload = {\n    data_type: \"youtube\",\n    user_name: window.global_this_obj.state.user_name,\n    event: yt_event,\n    videoId: videoId,\n    startSeconds: startSeconds,\n    playbackRate: playbackRate\n  };\n\n  return payload;\n}\n// {\n//   \"data_type\": \"chat|youtube|webrtc\",\n//   \"user_name\": \"Nishit\",\n//   \"user_type\": \"Host|Client\",\n//   \"message\": \"Test\",\n//   \"time_stamp\": \"ISO timestamp\"\n// }\n\n// misc\n\nfunction handle_intro(data) {\n  var connected_users = window.global_this_obj.state.connected_users;\n  connected_users[data.peer_id] = {\n    user_name: data.user_name,\n    color_code: data.color_code\n  };\n  window.global_this_obj.setState({ connected_users: connected_users });\n  window.global_this_obj.notify(`${data.user_name} has joined the party`);\n  if (window.is_host) {\n    update_data(window.peer_obj.id, \"connected_users\", connected_users);\n    setTimeout(function() {\n      sync_video();\n      var msg_user_list = {\n        data_type: \"user_list\",\n        user_list: window.global_this_obj.state.connected_users,\n        only_host_controls: window.global_this_obj.state.only_host_controls\n      };\n      send_data(msg_user_list);\n    }, 250);\n  }\n}\n\nfunction handle_intro_init(data) {\n  window.global_this_obj.setState({\n    connected_users: data.user_list,\n    only_host_controls: data.only_host_controls\n  });\n}\n\nexport function introduce(user_name, color_code) {\n  var format = {\n    data_type: \"intro\",\n    user_name: user_name,\n    peer_id: window.peer_obj.id,\n    color_code: color_code,\n    time_stamp: Date.now()\n  };\n  send_data(format);\n}\n\nexport function change_video(video_id, broadcast = false) {\n  var player = window.yt_player;\n  player.loadVideoById(video_id);\n  if (broadcast) {\n    var format = {\n      data_type: \"change_video\",\n      video_id: video_id\n    };\n    send_data(format);\n    // broadcast it to everyone\n  }\n}\n\nexport function parseIdFromURL(url) {\n  var regExp = /^.*(youtu\\.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=)([^#\\&\\?]*).*/;\n  var match = url.match(regExp);\n  if (match && match[2].length === 11) {\n    return match[2];\n  } else {\n    return false;\n  }\n}\n","import React from \"react\";\nimport { createConnection } from \"../utils/webRTC_utils\";\nimport { Redirect } from \"react-router-dom\";\nimport { store_data } from \"../utils/data_storage_utils\";\n\nclass Host extends React.Component {\n  state = {\n    user_name: \"\",\n    youtube_video_id: \"\",\n    host_peer_id: null,\n    is_host: true,\n    submitted: false\n  };\n  handleSubmit = e => {\n    e.preventDefault();\n    const video_id = this.parseIdFromURL(e.target.youtubeLink.value);\n    this.setState({\n      user_name: e.target.userName.value,\n      youtube_video_id: video_id,\n      only_host_controls: e.target.onlyHost.checked,\n      submitted: true\n    });\n    createConnection(true).then((peerId) => {\n      this.setState({host_peer_id: peerId});\n    });\n  };\n  parseIdFromURL = url => {\n    const regExp = /^.*(youtu\\.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=)([^#\\&\\?]*).*/;\n    const match = url.match(regExp);\n    if (match && match[2].length === 11) {\n      return match[2];\n    } else {\n      return false;\n    }\n  };\n  render() {\n    if (this.state.host_peer_id) {\n      store_data(this.state.host_peer_id, this.state);\n\n      return (\n        <Redirect\n          push\n          to={{\n            pathname: this.state.host_peer_id,\n            state: this.state\n          }}\n        ></Redirect>\n      );\n    }\n    return (\n      <section className=\"section\">\n        <div className=\"container\">\n          <div className=\"columns is-centered\">\n            <div className=\"column is-half\">\n              <div className=\"card box\">\n                <div className=\"card-content\">\n                  <form onSubmit={this.handleSubmit}>\n                    <div className=\"field\">\n                      <label className=\"label\">Username</label>\n                      <div className=\"control\">\n                        <input\n                          className=\"input\"\n                          placeholder=\"Please enter your username\"\n                          type=\"text\"\n                          name=\"userName\"\n                          required\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"field\">\n                      <label className=\"label\">Youtube Link</label>\n                      <div className=\"control\">\n                        <input\n                          className=\"input\"\n                          placeholder=\"The Youtube link to be shared\"\n                          type=\"url\"\n                          name=\"youtubeLink\"\n                          required\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"field\">\n                      <label className=\"checkbox\">\n                        <input type=\"checkbox\" name=\"onlyHost\"/>\n                        &nbsp;Only allow host to control video\n                      </label>\n                    </div>\n                    <div className=\"buttons is-right\">\n                      <button\n                        className={\n                          \"button is-primary\" +\n                          (this.state.submitted ? \" is-loading\" : \"\")\n                        }\n                      >\n                        Party\n                      </button>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n    );\n  }\n}\n\nexport default Host;\n","import React from \"react\";\n\nclass ChatBubble extends React.Component {\n  render() {\n    return (\n      <div className=\"chat-bubble\">\n        <span\n          className=\"chat_user_name\"\n          style={{ color: \"#\" + this.props.chat_data.color_code }}\n        >\n          {this.props.chat_data.user_name}\n        </span>\n        {this.props.chat_data.message}\n      </div>\n    );\n  }\n}\n\nexport default ChatBubble;\n","import React from \"react\";\n\nconst UserList = ({connectedUsers}) => {\n  return (\n    <div className=\"username-container\">\n      {Object.entries(connectedUsers).map(([_, userInfo]) =>\n        <span className={`tag ${userInfo.color_code}`}>{userInfo.user_name}</span>\n      )}\n    </div>\n  );\n};\n\nexport default UserList;\n","import React from \"react\";\nimport { send_chat } from \"../utils/webRTC_utils\";\nimport ChatBubble from \"./ChatBubble\";\nimport UserList from \"./UserList\";\n\nclass Chat extends React.Component {\n  constructor(props) {\n    super(props);\n    this.chatBottom = React.createRef();\n    this.state = {\n      message: '',\n    };\n  }\n\n  componentDidUpdate() {\n    this.chatBottom.current.scrollIntoView({ behavior: \"smooth\" });\n  }\n\n  add_text = e => {\n    this.setState({ message: e.target.value });\n  };\n\n  send_message = e => {\n    e.preventDefault();\n    if (this.state.message === \"\") {\n      return;\n    }\n    send_chat(\n      this.state.message,\n      this.props.user_name,\n      this.props.is_host,\n      this.props.color_code\n    );\n    this.setState({ message: \"\" });\n  };\n\n  render() {\n    return (\n      <div className=\"chat-panel box\">\n        <UserList\n          connectedUsers={this.props.connected_users}\n          only_host_controls={this.props.only_host_controls}\n          is_host={this.props.is_host}\n        />\n        <div className=\"chat-message-panel\">\n          {this.props.chat_log.map((chat_data, index) => {\n            return <ChatBubble key={index} chat_data={chat_data}/>;\n          })}\n          <span ref={this.chatBottom} id=\"chat-bottom\" />\n        </div>\n        <form onSubmit={this.send_message}>\n          <div className=\"field is-grouped\">\n            <p className=\"control is-expanded\">\n              <input\n                className=\"input\"\n                value={this.state.message}\n                type=\"text\"\n                placeholder=\"Chat...\"\n                onChange={this.add_text}\n              />\n            </p>\n            <p className=\"control\">\n              <button className=\"button is-primary\">\n                <i\n                  className=\"icon icon ion-ios-paperplane\"\n                  style={{\n                    fontSize: \"xx-large\",\n                    alignItems: \"normal\",\n                    height: \"1em\"\n                  }}\n                ></i>\n              </button>\n            </p>\n          </div>\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default Chat;\n","import React from \"react\";\nimport { sync_video } from \"../utils/webRTC_utils\";\n\nclass Player extends React.Component {\n  constructor(props) {\n    super(props);\n    console.log(props);\n    this.state = {\n      player: \"\"\n    };\n  }\n  componentDidUpdate() {\n    if (this.state.player === \"\" && this.props.youtube_video_id !== \"\") {\n      this.loadScript();\n    }\n  }\n  loadScript = () => {\n    if (!window.YT) {\n      // If not, load the script asynchronously\n      const tag = document.createElement(\"script\");\n      tag.src = \"https://www.youtube.com/iframe_api\";\n\n      // onYouTubeIframeAPIReady will load the video after the script is loaded\n      window.onYouTubeIframeAPIReady = this.loadVideo;\n\n      const firstScriptTag = document.getElementsByTagName(\"script\")[0];\n      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n    } else {\n      // If script is already there, load the video directly\n      if (window.YT.Player) {\n        this.loadVideo();\n      }\n    }\n  };\n  loadVideo = () => {\n    const playerHeight = Math.round(window.innerHeight * 0.7);\n    const playerWidth = Math.round(playerHeight * 16/9);\n    this.state.player = new window.YT.Player('youtube-player-iframe', {\n      videoId: this.props.youtube_video_id,\n      width: playerWidth,\n      height: playerHeight,\n      playerVars: {\n        start: Math.ceil(this.props.youtube_current_pos)\n      },\n      events: {\n        onReady: this.onPlayerReady,\n        onStateChange: this.onPlayerStateChange,\n        onPlaybackRateChange: this.onPlayerPlaybackRateChange\n      }\n    });\n    window.yt_player = this.state.player;\n  };\n\n  onPlayerReady = event => {\n    if (this.props.player_state === 1) {\n      event.target.playVideo();\n    }\n  };\n  onPlayerStateChange = event => {\n    if (!this.props.isStateChangeFromBroadcastData) {\n      if (\n        event.data === window.YT.PlayerState.PLAYING ||\n        event.data === window.YT.PlayerState.PAUSED\n      ) {\n        sync_video();\n      }\n    }\n  };\n  onPlayerPlaybackRateChange = event => {\n    console.log(event);\n    if (this.props.is_host) {\n      sync_video(\"playbackRateChange\");\n    }\n  };\n  render() {\n    // if (!this.props.youtube_video_id) {\n    //   return <div>Video not loaded</div>;\n    // }\n    return (\n      <div className=\"player_container\">\n        <div id={`youtube-player-iframe`} />\n      </div>\n    );\n  }\n}\n\nexport default Player;\n","import React from \"react\";\nimport { change_video, parseIdFromURL } from \"../utils/webRTC_utils\";\n\nclass ChangeVideo extends React.Component {\n  changeVideo = e => {\n    e.preventDefault();\n    let video_url = e.target.video_url.value;\n    let video_id = parseIdFromURL(video_url);\n    if (video_id) {\n      change_video(video_id, true);\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"box info_box\">\n        <div className=\"\">\n          <form onSubmit={this.changeVideo}>\n            <div className=\"field is-grouped\">\n              <p className=\"control is-expanded\">\n                <input\n                  className=\"input\"\n                  type=\"text\"\n                  name=\"video_url\"\n                  placeholder=\"Enter new video URL\"\n                  required\n                />\n              </p>\n              <p className=\"control\">\n                <button className=\"button is-primary\">Change</button>\n              </p>\n            </div>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ChangeVideo;\n","import React from \"react\";\nimport ChatPanel from \"./Chat\";\nimport Player from \"./Player\";\nimport ChangeVideo from \"./ChangeVideo\";\n\nimport { get_data } from \"../utils/data_storage_utils\";\nimport {\n  createConnection,\n  introduce,\n  bulk_connect\n} from \"../utils/webRTC_utils\";\nimport { ToastContainer, toast } from \"react-toastify\";\n// css\nimport \"react-toastify/dist/ReactToastify.min.css\";\n\nfunction getRandomTagColor() {\n  const bulmaTagColors = ['is-black', 'is-dark', 'is-light', 'is-primary', 'is-link', 'is-info', 'is-success', 'is-warning', 'is-danger'];\n  return bulmaTagColors[Math.floor(Math.random() * bulmaTagColors.length)];\n}\n\n// https://stackoverflow.com/questions/54017100/how-to-integrate-youtube-iframe-api-in-reactjs-solution\nclass Party extends React.Component {\n  state = {\n    user_name: \"\",\n    youtube_video_id: \"\",\n    youtube_current_pos: 0,\n    peer_id: \"\",\n    is_host: false,\n    chat_log: [],\n    invite_popup_shown: false,\n    connected_users: {},\n    color_code: \"\",\n    isStateChangeFromBroadcastData: false,\n    player_state: false\n  };\n\n  constructor(props) {\n    super(props);\n    window.global_this_obj = this;\n    window.peer_ids = [];\n    window.connections = [];\n  }\n\n  componentDidMount() {\n    const data = get_data(this.props.match.params.host_id);\n    const color_code = getRandomTagColor();\n    // i.e if host\n    if (data) {\n      if (!window.peer_obj) {\n        createConnection(true, null, this.props.match.params.host_id);\n      }\n\n      if (!data.connected_users) {\n        var connected_users = {};\n        connected_users[this.props.match.params.host_id] = {\n          user_name: data.user_name,\n          color_code: color_code,\n          is_host: true\n        };\n      } else {\n        var connected_users = data.connected_users;\n        // https://stackoverflow.com/questions/38416020/deep-copy-in-es6-using-the-spread-syntax\n        var reconnect_users = JSON.parse(JSON.stringify(connected_users));\n\n        delete reconnect_users[this.props.match.params.host_id];\n        bulk_connect(\n          Object.keys(reconnect_users),\n          connected_users[this.props.match.params.host_id]\n        );\n      }\n\n      this.setState({\n        peer_id: this.props.match.params.host_id,\n        user_name: data.user_name,\n        youtube_video_id: data.youtube_video_id,\n        only_host_controls: data.only_host_controls,\n        is_host: data.is_host,\n        connected_users: connected_users,\n        color_code: color_code\n      });\n    } else {\n      // Not a host: Create connection\n      createConnection(false, this.props.match.params.host_id);\n    }\n  }\n\n  setUserName = e => {\n    e.preventDefault();\n    const color_code = getRandomTagColor();\n    const connected_users = this.state.connected_users;\n    connected_users[this.state.peer_id] = {\n      user_name: e.target.user_name.value,\n      color_code: color_code,\n      is_host: false\n    };\n    this.setState({\n      user_name: e.target.user_name.value,\n      connected_users: connected_users,\n      color_code: color_code\n    });\n    introduce(e.target.user_name.value, color_code);\n  };\n\n  copyToClipboard = e => {\n    e.preventDefault();\n    this.copy_invite.select();\n    document.execCommand(\"copy\");\n    this.setState({ invite_popup_shown: true });\n  };\n\n  closeModal = e => {\n    this.setState({ invite_popup_shown: true });\n  };\n\n  notify = (message, timeout = 3000) => {\n    toast.info(message, {\n      position: \"bottom-left\",\n      autoClose: timeout,\n      hideProgressBar: false,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true,\n      progress: undefined,\n      toastId: message\n    });\n  };\n\n  render() {\n    return (\n      <div className=\"party-container\">\n        <ToastContainer\n          position=\"bottom-left\"\n          autoClose={3000}\n          hideProgressBar={false}\n          newestOnTop={false}\n          closeOnClick\n          rtl={false}\n          pauseOnFocusLoss={false}\n          draggable\n          pauseOnHover\n        />\n        <div\n          className={\n            \"modal   \" + (this.state.user_name === \"\" ? \"is-active\" : \"\")\n          }\n        >\n          <div className=\"modal-background\"></div>\n          <div className=\"modal-content\">\n            <div className=\"box\">\n              <form onSubmit={this.setUserName}>\n                <div className=\"field is-grouped\">\n                  <p className=\"control is-expanded\">\n                    <input\n                      className=\"input\"\n                      type=\"text\"\n                      name=\"user_name\"\n                      placeholder=\"Enter Your Username\"\n                      required\n                    />\n                  </p>\n                  <p className=\"control\">\n                    <button className=\"button is-primary\">Party</button>\n                  </p>\n                </div>\n              </form>\n            </div>\n          </div>\n          <button className=\"modal-close is-large\" aria-label=\"close\"></button>\n        </div>\n\n        <div className={\"modal \" + (this.state.invite_popup_shown ? \"is-active\" : \"\")}>\n          <div className=\"modal-background\" onClick={this.closeModal}></div>\n          <div className=\"modal-content\">\n            <div className=\"box\">\n              <form onSubmit={this.copyToClipboard}>\n                <label>Share this link with friends to watch YouTube together</label>\n\n                <div className=\"field is-grouped\">\n                  <p className=\"control is-expanded\">\n                    <input\n                      className=\"input\"\n                      type=\"text\"\n                      value={window.location.href}\n                      name=\"invite_link\"\n                      readOnly\n                      ref={copy_invite => (this.copy_invite = copy_invite)}\n                    />\n                  </p>\n                  <p className=\"control\">\n                    <button className=\"button is-primary\">\n                      <span role=\"img\" aria-label=\"cliboard_emoji\">\n                        ðŸ“‹\n                      </span>\n                      &nbsp;Copy Invite Link\n                    </button>\n                  </p>\n                </div>\n              </form>\n            </div>\n          </div>\n          <button\n            className=\"modal-close is-large\"\n            aria-label=\"close\"\n            onClick={this.closeModal}\n          />\n        </div>\n\n        <div>\n          <Player\n            youtube_video_id={this.state.youtube_video_id}\n            youtube_current_pos={this.state.youtube_current_pos}\n            is_host={this.state.is_host}\n            isStateChangeFromBroadcastData={\n              this.state.isStateChangeFromBroadcastData\n            }\n            player_state={this.state.player_state}\n          />\n          {(this.state.only_host_controls === false || this.state.is_host === true) && <ChangeVideo/>}\n        </div>\n        <ChatPanel\n          connected_users={this.state.connected_users}\n          only_host_controls={this.state.only_host_controls}\n          user_name={this.state.user_name}\n          chat_log={this.state.chat_log}\n          is_host={this.state.is_host}\n          color_code={this.state.color_code}\n        />\n      </div>\n    );\n  }\n}\nexport default Party;\n","import React from \"react\";\nimport { HashRouter, Route, Switch } from \"react-router-dom\";\nimport Host from \"./Host\";\nimport Party from \"./Party\";\nconst Router = () => (\n  <HashRouter>\n    <Switch>\n      <Route exact path=\"/\" component={Host} />\n      <Route exact path=\"/:host_id\" component={Party} />\n    </Switch>\n  </HashRouter>\n);\nexport default Router;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./App.scss\";\nimport Router from \"./components/Router\";\nimport * as serviceWorker from \"./serviceWorker\";\nReactDOM.render(\n  <React.StrictMode>\n    <Router />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}