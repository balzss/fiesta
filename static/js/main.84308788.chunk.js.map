{"version":3,"sources":["utils/data_storage_utils.js","utils/webRTC_utils.js","components/Host.js","components/ChatBubble.js","components/UserList.js","components/Chat.js","components/Player.js","components/ChangeVideo.js","components/Party.js","components/Join.js","components/HomePage.js","components/Router.js","serviceWorker.js","index.js"],"names":["store_data","key","data","localStorage","setItem","btoa","JSON","stringify","encode_base64","update_data","data_key","value","get_data","getItem","parse","atob","decode_base64","createConnection","thisObj","is_host","host_id","previous_id","peer_js_url","process","REACT_APP_PEERJS","turn_url","REACT_APP_TURN","turn_username","REACT_APP_TURN_USERNAME","turn_credentials","REACT_APP_TURN_CREDENTIALS","Peer","window","settings","debug","config","iceServers","urls","host","port","path","push","username","credential","peer","peer_obj","conn","connect","handle_connection","on","id","console","log","peer_id","setState","host_peer_id","global_this_obj","notify","peer_ids","data_type","chat_handler","connect_to_peer","state","youtube_video_id","videoId","youtube_current_pos","Math","ceil","startSeconds","player_state","event","isStateChangeFromBroadcastData","player","yt_player","seekTo","pauseVideo","user_name","playVideo","setPlaybackRate","playbackRate","setTimeout","handle_youtube","connected_users","color_code","sync_video","send_data","user_list","only_host_controls","handle_intro","handle_intro_init","change_video","video_id","data_handler","left_user_name","connections","msg","i","length","send","broadcast_new_connection","chat_data","chat_log","message","decodeURIComponent","escape","send_chat","msg_json","user_type","unescape","encodeURIComponent","time_stamp","Date","now","generate_chat_structure","payload_data","fetch_current_video_status","yt_event","getPlayerState","getVideoData","getCurrentTime","getPlaybackRate","introduce","broadcast","loadVideoById","format","parseIdFromURL","url","match","Host","submitted","handleSubmit","e","preventDefault","target","youtubeLink","onlyHost","checked","userName","this","to","pathname","className","onSubmit","placeholder","type","name","required","ref","youtubeLinkRef","onlyHostRef","React","Component","ChatBubble","style","color","props","UserList","connectedUsers","Object","entries","map","userInfo","Chat","add_text","send_message","chatBottom","createRef","current","scrollIntoView","behavior","index","onChange","fontSize","alignItems","height","Player","loadScript","YT","loadVideo","tag","document","createElement","src","onYouTubeIframeAPIReady","firstScriptTag","getElementsByTagName","parentNode","insertBefore","playerHeight","round","innerHeight","playerWidth","width","playerVars","start","events","onReady","onPlayerReady","onStateChange","onPlayerStateChange","onPlaybackRateChange","onPlayerPlaybackRateChange","PlayerState","PLAYING","PAUSED","ChangeVideo","changeVideo","video_url","getRandomTagColor","bulmaTagColors","floor","random","Party","invite_popup_shown","setUserName","copyToClipboard","copy_invite","select","execCommand","closeModal","timeout","toast","info","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","toastId","params","reconnect_users","host_data","wait_time","bulk_connect","keys","newestOnTop","rtl","pauseOnFocusLoss","aria-label","onClick","location","href","readOnly","role","Join","useState","roomId","setRoomId","HomePage","Router","exact","component","Boolean","hostname","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.84308788.chunk.js","sourcesContent":["export function encode_base64(data) {\n  return btoa(JSON.stringify(data));\n}\n\nexport function decode_base64(data) {\n  return JSON.parse(atob(data));\n}\n\nexport function store_data(key, data) {\n  localStorage.setItem(key, encode_base64(data));\n}\n\nexport function update_data(data_key, key, value) {\n  var data = get_data(data_key);\n  if (!data) {\n    return false;\n  }\n  data[key] = value;\n  store_data(data_key, data);\n}\n\nexport function get_data(key) {\n  var data = localStorage.getItem(key);\n  if (data) {\n    return decode_base64(data);\n  }\n  return false;\n}\n","import { update_data } from \"./data_storage_utils\";\n\nexport var global_this_obj = null;\n\nexport function createConnection(\n  thisObj,\n  is_host,\n  host_id = null,\n  previous_id = null\n) {\n  let peer_js_url = process.env.REACT_APP_PEERJS;\n  let turn_url = process.env.REACT_APP_TURN;\n  let turn_username = process.env.REACT_APP_TURN_USERNAME;\n  let turn_credentials = process.env.REACT_APP_TURN_CREDENTIALS;\n  const Peer = window.Peer;\n  const settings = {\n    debug: 2,\n    // iceTransportPolicy: \"relay\",\n    config: {\n      iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }]\n    }\n  };\n  if (peer_js_url) {\n    settings.host = peer_js_url;\n    settings.port = \"\";\n    settings.path = \"/myapp\";\n  }\n  if (turn_url) {\n    settings.config.iceServers.push({\n      urls: turn_url,\n      username: turn_username,\n      credential: turn_credentials\n    });\n  }\n\n  if (previous_id) {\n    var peer = new Peer(previous_id, settings);\n  } else {\n    var peer = new Peer(settings);\n  }\n\n  window.peer_obj = peer;\n  window.is_host = is_host;\n  if (is_host !== true) {\n    var conn = peer.connect(host_id);\n    handle_connection(conn);\n  }\n\n  peer.on(\"open\", function(id) {\n    console.log(\"MY peer ID is \" + peer.id);\n    window.peer_id = peer.id;\n    thisObj.setState({\n      peer_id: peer.id\n    });\n    if (window.is_host === true) {\n      thisObj.setState({\n        host_peer_id: peer.id\n      });\n    }\n  });\n\n  //   Initializes connection\n  peer.on(\"connection\", function(conn) {\n    console.log(\"connection called\");\n    handle_connection(conn);\n  });\n\n  peer.on(\"close\", function() {\n    console.log(\"peer closed\");\n    window.global_this_obj.notify(\"Network disconnected please refresh\", 10000);\n  });\n\n  peer.on(\"disconnected\", function() {\n    console.log(\"peer disconnected\");\n    // peer.reconnect();\n    window.global_this_obj.notify(\"Network disconnected please refresh\", 10000);\n  });\n\n  // peer.on(\"error\", function(err) {\n  // window.global_this_obj.notify(\"Network disconnected please refresh\",10000);\n\n  //   console.log(`peerjs error ${err}`);\n  //   var x = 0;\n  //   var intervalID = setInterval(function() {\n  //     if (is_online()) {\n  //       createConnection(\n  //         window.global_this_obj,\n  //         window.is_host,\n  //         window.global_this_obj.props.match.params.host_id,\n  //         window.peer_id\n  //       );\n  //       window.clearInterval(intervalID);\n  //     }\n\n  //     if (++x === 10) {\n  //       window.clearInterval(intervalID);\n  //     }\n  //   }, 1000);\n  // });\n}\n\nfunction is_online() {\n  fetch(\"https://corona-api.nishit.xyz/country/in\")\n    .then(response => {\n      return true;\n    })\n    .catch(error => {\n      return false;\n    });\n}\n\nfunction handle_connection(conn) {\n  window.peer_ids.push(conn.peer);\n\n  conn.on(\"data\", function(data) {\n    console.log(\"data received\");\n    console.log(data);\n    data_handler(data);\n  });\n  console.log(\"Handled connection\");\n\n  conn.on(\"close\", function() {\n    var connected_users = window.global_this_obj.state.connected_users;\n    if (!connected_users || !connected_users[conn.peer]) {\n      return;\n    }\n    const left_user_name = connected_users[conn.peer].user_name;\n    delete connected_users[conn.peer];\n    window.global_this_obj.setState({ connected_users: connected_users });\n    window.global_this_obj.notify(`${left_user_name} has left the party`);\n    if (window.is_host) {\n      update_data(window.peer_obj.id, \"connected_users\", connected_users);\n    }\n  });\n\n  window.connections.push(conn);\n\n  if (window.is_host === true) {\n    // setTimeout(function() {\n    //   sync_video();\n    //   var msg_user_list = {\n    //     data_type: \"user_list\",\n    //     user_list: window.global_this_obj.state.connected_users,\n    //     only_host_controls: window.global_this_obj.state.only_host_controls\n    //   };\n    //   send_data(msg_user_list);\n    // }, 3000);\n    broadcast_new_connection(conn.peer);\n  }\n}\n\nfunction data_handler(data) {\n  if (typeof data === \"object\" && data !== null) {\n    if (data.data_type === \"chat\") {\n      chat_handler(data);\n    } else if (data.data_type === \"new_connection\") {\n      connect_to_peer(data.peer_id);\n    } else if (data.data_type === \"youtube\") {\n      handle_youtube(data);\n    } else if (data.data_type === \"intro\") {\n      handle_intro(data);\n    } else if (data.data_type === \"user_list\") {\n      handle_intro_init(data);\n    } else if (data.data_type === \"change_video\") {\n      change_video(data.video_id);\n    }\n  }\n}\n\nfunction send_data(data) {\n  console.log(\"Sending data: \");\n  console.log(data);\n  var connections = window.connections;\n  for (var i = 0; i < connections.length; i++) {\n    connections[i].send(data);\n  }\n}\n\nfunction broadcast_new_connection(peer_id) {\n  var msg = { data_type: \"new_connection\", peer_id: peer_id };\n  for (var i = 0; i < window.connections.length; i++) {\n    if (window.connections[i].peer === peer_id) {\n      continue;\n    }\n    window.connections[i].send(msg);\n  }\n}\n\nfunction connect_to_peer(peer_id) {\n  var conn = window.peer_obj.connect(peer_id);\n  handle_connection(conn);\n}\n\nexport function bulk_connect(peer_ids, host_data) {\n  for (let id in peer_ids) {\n    setTimeout(function() {\n      connect_to_peer(peer_ids[id]);\n    }, 250);\n  }\n  const wait_time = 250 * peer_ids.length + 100;\n  setTimeout(function() {\n    console.log(\"intro called\");\n    introduce(host_data.user_name, host_data.color_code);\n  }, wait_time);\n}\n// Chat utils\nfunction chat_handler(chat_data) {\n  var chat_log = window.global_this_obj.state.chat_log;\n  chat_data.message = decodeURIComponent(\n    escape(window.atob(chat_data.message))\n  );\n\n  chat_log.push(chat_data);\n  window.global_this_obj.setState({\n    chat_log: chat_log\n  });\n}\n\nexport function send_chat(msg, user_name, is_host, color_code) {\n  var msg_json = generate_chat_structure(msg, user_name, is_host, color_code);\n  send_data(msg_json);\n  chat_handler(msg_json);\n}\n\nfunction generate_chat_structure(msg, user_name, is_host, color_code) {\n  var format = {\n    data_type: \"chat\",\n    user_name: user_name,\n    user_type: is_host ? \"Host\" : \"Client\",\n    message: btoa(unescape(encodeURIComponent(msg))),\n    color_code: color_code,\n    time_stamp: Date.now()\n  };\n  return format;\n}\n\n//  Youtube utils\n\nfunction handle_youtube(data) {\n  var state = window.global_this_obj.state;\n  if (state.youtube_video_id === \"\") {\n    window.global_this_obj.setState({\n      youtube_video_id: data.videoId,\n      youtube_current_pos: Math.ceil(data.startSeconds),\n      player_state: data.event\n    });\n  } else {\n    window.global_this_obj.setState({ isStateChangeFromBroadcastData: true });\n    const player = window.yt_player;\n\n    if (data.event === 2) {\n      // isStateChangeFromBroadcastData = true;\n      player.seekTo(data.startSeconds, true);\n      player.pauseVideo();\n      window.global_this_obj.notify(`${data.user_name} paused the video`);\n    } else if (data.event === 1) {\n      // isStateChangeFromBroadcastData = true;\n      player.seekTo(Math.ceil(data.startSeconds), true);\n      player.playVideo();\n      window.global_this_obj.notify(`${data.user_name} started the video`);\n    } else if (data.event === 3) {\n      // isStateChangeFromBroadcastData = true;\n      player.seekTo(data.startSeconds, true);\n      player.pauseVideo();\n      window.global_this_obj.notify(`${data.user_name} is buffering`);\n    } else if (data.event === \"playbackRateChange\") {\n      player.seekTo(data.startSeconds, true);\n      player.setPlaybackRate(data.playbackRate);\n      window.global_this_obj.notify(\n        `${data.user_name} changed the playback rate to ${data.playbackRate}x`\n      );\n    }\n    setTimeout(function() {\n      window.global_this_obj.setState({\n        isStateChangeFromBroadcastData: false\n      });\n    }, 2500);\n  }\n}\n\nexport function sync_video(event = null) {\n  if (\n    window.global_this_obj.state.only_host_controls === true &&\n    window.is_host !== true\n  ) {\n    return;\n  }\n  if (window.global_this_obj.state.isStateChangeFromBroadcastData) {\n    return;\n  }\n  var payload_data = fetch_current_video_status(event);\n  send_data(payload_data);\n}\n\nfunction fetch_current_video_status(event) {\n  var yt_event;\n  const player = window.yt_player;\n  if (event !== null) {\n    yt_event = event;\n  } else {\n    yt_event = player.getPlayerState();\n  }\n\n  var videoId = player.getVideoData()[\"video_id\"];\n  var startSeconds = player.getCurrentTime();\n  var playbackRate = player.getPlaybackRate();\n\n  var payload = {\n    data_type: \"youtube\",\n    user_name: window.global_this_obj.state.user_name,\n    event: yt_event,\n    videoId: videoId,\n    startSeconds: startSeconds,\n    playbackRate: playbackRate\n  };\n\n  return payload;\n}\n// {\n//   \"data_type\": \"chat|youtube|webrtc\",\n//   \"user_name\": \"Nishit\",\n//   \"user_type\": \"Host|Client\",\n//   \"message\": \"Test\",\n//   \"time_stamp\": \"ISO timestamp\"\n// }\n\n// misc\n\nfunction handle_intro(data) {\n  var connected_users = window.global_this_obj.state.connected_users;\n  connected_users[data.peer_id] = {\n    user_name: data.user_name,\n    color_code: data.color_code\n  };\n  window.global_this_obj.setState({ connected_users: connected_users });\n  window.global_this_obj.notify(`${data.user_name} has joined the party`);\n  if (window.is_host) {\n    update_data(window.peer_obj.id, \"connected_users\", connected_users);\n    setTimeout(function() {\n      sync_video();\n      var msg_user_list = {\n        data_type: \"user_list\",\n        user_list: window.global_this_obj.state.connected_users,\n        only_host_controls: window.global_this_obj.state.only_host_controls\n      };\n      send_data(msg_user_list);\n    }, 250);\n  }\n}\n\nfunction handle_intro_init(data) {\n  window.global_this_obj.setState({\n    connected_users: data.user_list,\n    only_host_controls: data.only_host_controls\n  });\n}\n\nexport function introduce(user_name, color_code) {\n  var format = {\n    data_type: \"intro\",\n    user_name: user_name,\n    peer_id: window.peer_obj.id,\n    color_code: color_code,\n    time_stamp: Date.now()\n  };\n  send_data(format);\n}\n\nexport function change_video(video_id, broadcast = false) {\n  var player = window.yt_player;\n  player.loadVideoById(video_id);\n  if (broadcast) {\n    var format = {\n      data_type: \"change_video\",\n      video_id: video_id\n    };\n    send_data(format);\n    // broadcast it to everyone\n  }\n}\n\nexport function parseIdFromURL(url) {\n  var regExp = /^.*(youtu\\.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=)([^#\\&\\?]*).*/;\n  var match = url.match(regExp);\n  if (match && match[2].length === 11) {\n    return match[2];\n  } else {\n    return false;\n  }\n}\n","import React from \"react\";\nimport { createConnection } from \"../utils/webRTC_utils\";\nimport { Redirect } from \"react-router-dom\";\nimport { store_data } from \"../utils/data_storage_utils\";\n\nclass Host extends React.Component {\n  state = {\n    user_name: \"\",\n    youtube_video_id: \"\",\n    host_peer_id: null,\n    is_host: true,\n    submitted: false\n  };\n  handleSubmit = e => {\n    e.preventDefault();\n    const video_id = this.parseIdFromURL(e.target.youtubeLink.value);\n    console.log(e.target.onlyHost.checked);\n    this.setState({\n      user_name: e.target.userName.value,\n      youtube_video_id: video_id,\n      only_host_controls: e.target.onlyHost.checked,\n      submitted: true\n    });\n    createConnection(this, true);\n  };\n  parseIdFromURL = url => {\n    const regExp = /^.*(youtu\\.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=)([^#\\&\\?]*).*/;\n    const match = url.match(regExp);\n    if (match && match[2].length === 11) {\n      return match[2];\n    } else {\n      return false;\n    }\n  };\n  render() {\n    if (this.state.host_peer_id) {\n      store_data(this.state.host_peer_id, this.state);\n\n      return (\n        <Redirect\n          push\n          to={{\n            pathname: \"party/\" + this.state.host_peer_id,\n            state: this.state\n          }}\n        ></Redirect>\n      );\n    }\n    return (\n      <section className=\"section\">\n        <div className=\"container\">\n          <div className=\"columns is-centered\">\n            <div className=\"column is-half\">\n              <div className=\"card box\">\n                <div className=\"card-content\">\n                  <form onSubmit={this.handleSubmit}>\n                    <div className=\"field\">\n                      <label className=\"label\">Username</label>\n                      <div className=\"control\">\n                        <input\n                          className=\"input\"\n                          placeholder=\"Please enter your username\"\n                          type=\"text\"\n                          name=\"userName\"\n                          required\n                        ></input>\n                      </div>\n                    </div>\n\n                    <div className=\"field\">\n                      <label className=\"label\">Youtube Link</label>\n                      <div className=\"control\">\n                        <input\n                          className=\"input\"\n                          ref={this.youtubeLinkRef}\n                          placeholder=\"The Youtube link to be shared\"\n                          type=\"url\"\n                          name=\"youtubeLink\"\n                          required\n                        ></input>\n                      </div>\n                    </div>\n\n                    <div className=\"field\">\n                      <label className=\"checkbox\">\n                        <input\n                          type=\"checkbox\"\n                          name=\"onlyHost\"\n                          ref={this.onlyHostRef}\n                        />\n                        &nbsp;Only allow host to control video\n                      </label>\n                    </div>\n                    <div className=\"buttons is-right\">\n                      <button\n                        className={\n                          \"button is-primary\" +\n                          (this.state.submitted ? \" is-loading\" : \"\")\n                        }\n                      >\n                        Party\n                      </button>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n    );\n  }\n}\n\nexport default Host;\n","import React from \"react\";\n\nclass ChatBubble extends React.Component {\n  render() {\n    return (\n      <div className=\"chat-bubble\">\n        <span\n          className=\"chat_user_name\"\n          style={{ color: \"#\" + this.props.chat_data.color_code }}\n        >\n          {this.props.chat_data.user_name}\n        </span>\n        {this.props.chat_data.message}\n      </div>\n    );\n  }\n}\n\nexport default ChatBubble;\n","import React from \"react\";\n\nconst UserList = ({connectedUsers}) => {\n  return (\n    <div className=\"avatar_container\">\n      {Object.entries(connectedUsers).map(([_, userInfo]) =>\n        <span className={`tag ${userInfo.color_code}`}>{userInfo.user_name}</span>\n      )}\n    </div>\n  );\n};\n\nexport default UserList;\n","import React from \"react\";\nimport { send_chat } from \"../utils/webRTC_utils\";\nimport ChatBubble from \"./ChatBubble\";\nimport UserList from \"./UserList\";\n\nclass Chat extends React.Component {\n  constructor(props) {\n    super(props);\n    this.chatBottom = React.createRef();\n    this.state = {\n      message: '',\n    };\n  }\n\n  componentDidUpdate() {\n    this.chatBottom.current.scrollIntoView({ behavior: \"smooth\" });\n  }\n\n  add_text = e => {\n    this.setState({ message: e.target.value });\n  };\n\n  send_message = e => {\n    e.preventDefault();\n    if (this.state.message === \"\") {\n      return;\n    }\n    send_chat(\n      this.state.message,\n      this.props.user_name,\n      this.props.is_host,\n      this.props.color_code\n    );\n    this.setState({ message: \"\" });\n  };\n\n  render() {\n    return (\n      <div className=\"chat-panel box\">\n        <UserList\n          connectedUsers={this.props.connected_users}\n          only_host_controls={this.props.only_host_controls}\n          is_host={this.props.is_host}\n        />\n        <div className=\"chat-message-panel\">\n          {this.props.chat_log.map((chat_data, index) => {\n            return <ChatBubble key={index} chat_data={chat_data}/>;\n          })}\n          <span ref={this.chatBottom} id=\"chat-bottom\" />\n        </div>\n        <form onSubmit={this.send_message}>\n          <div className=\"field is-grouped\">\n            <p className=\"control is-expanded\">\n              <input\n                className=\"input\"\n                value={this.state.message}\n                type=\"text\"\n                placeholder=\"Chat...\"\n                onChange={this.add_text}\n              />\n            </p>\n            <p className=\"control\">\n              <button className=\"button is-primary\">\n                <i\n                  className=\"icon icon ion-ios-paperplane\"\n                  style={{\n                    fontSize: \"xx-large\",\n                    alignItems: \"normal\",\n                    height: \"1em\"\n                  }}\n                ></i>\n              </button>\n            </p>\n          </div>\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default Chat;\n","import React from \"react\";\nimport { sync_video } from \"../utils/webRTC_utils\";\n\nclass Player extends React.Component {\n  constructor(props) {\n    super(props);\n    console.log(props);\n    this.state = {\n      player: \"\"\n    };\n  }\n  componentDidUpdate() {\n    if (this.state.player === \"\" && this.props.youtube_video_id !== \"\") {\n      this.loadScript();\n    }\n  }\n  loadScript = () => {\n    if (!window.YT) {\n      // If not, load the script asynchronously\n      const tag = document.createElement(\"script\");\n      tag.src = \"https://www.youtube.com/iframe_api\";\n\n      // onYouTubeIframeAPIReady will load the video after the script is loaded\n      window.onYouTubeIframeAPIReady = this.loadVideo;\n\n      const firstScriptTag = document.getElementsByTagName(\"script\")[0];\n      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n    } else {\n      // If script is already there, load the video directly\n      if (window.YT.Player) {\n        this.loadVideo();\n      }\n    }\n  };\n  loadVideo = () => {\n    const playerHeight = Math.round(window.innerHeight * 0.7);\n    const playerWidth = Math.round(playerHeight * 16/9);\n    this.state.player = new window.YT.Player('youtube-player-iframe', {\n      videoId: this.props.youtube_video_id,\n      width: playerWidth,\n      height: playerHeight,\n      playerVars: {\n        start: Math.ceil(this.props.youtube_current_pos)\n      },\n      events: {\n        onReady: this.onPlayerReady,\n        onStateChange: this.onPlayerStateChange,\n        onPlaybackRateChange: this.onPlayerPlaybackRateChange\n      }\n    });\n    window.yt_player = this.state.player;\n  };\n\n  onPlayerReady = event => {\n    if (this.props.player_state === 1) {\n      event.target.playVideo();\n    }\n  };\n  onPlayerStateChange = event => {\n    if (!this.props.isStateChangeFromBroadcastData) {\n      if (\n        event.data === window.YT.PlayerState.PLAYING ||\n        event.data === window.YT.PlayerState.PAUSED\n      ) {\n        sync_video();\n      }\n    }\n  };\n  onPlayerPlaybackRateChange = event => {\n    console.log(event);\n    if (this.props.is_host) {\n      sync_video(\"playbackRateChange\");\n    }\n  };\n  render() {\n    // if (!this.props.youtube_video_id) {\n    //   return <div>Video not loaded</div>;\n    // }\n    return (\n      <div className=\"player_container\">\n        <div id={`youtube-player-iframe`} />\n      </div>\n    );\n  }\n}\n\nexport default Player;\n","import React from \"react\";\nimport { change_video, parseIdFromURL } from \"../utils/webRTC_utils\";\n\nclass ChangeVideo extends React.Component {\n  changeVideo = e => {\n    e.preventDefault();\n    let video_url = e.target.video_url.value;\n    let video_id = parseIdFromURL(video_url);\n    if (video_id) {\n      change_video(video_id, true);\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"box info_box\">\n        <div className=\"\">\n          <form onSubmit={this.changeVideo}>\n            <div className=\"field is-grouped\">\n              <p className=\"control is-expanded\">\n                <input\n                  className=\"input\"\n                  type=\"text\"\n                  name=\"video_url\"\n                  placeholder=\"Enter new video URL\"\n                  required\n                />\n              </p>\n              <p className=\"control\">\n                <button className=\"button is-primary\">Change</button>\n              </p>\n            </div>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ChangeVideo;\n","import React from \"react\";\nimport ChatPanel from \"./Chat\";\nimport Player from \"./Player\";\nimport ChangeVideo from \"./ChangeVideo\";\n\nimport { get_data } from \"../utils/data_storage_utils\";\nimport {\n  createConnection,\n  introduce,\n  bulk_connect\n} from \"../utils/webRTC_utils\";\nimport { ToastContainer, toast } from \"react-toastify\";\n// css\nimport \"react-toastify/dist/ReactToastify.min.css\";\n\nfunction getRandomTagColor() {\n  const bulmaTagColors = ['is-black', 'is-dark', 'is-light', 'is-white', 'is-primary', 'is-link', 'is-info', 'is-success', 'is-warning', 'is-danger'];\n  const color_code = bulmaTagColors[Math.floor(Math.random() * bulmaTagColors.length)];\n  return color_code;\n}\n\n// https://stackoverflow.com/questions/54017100/how-to-integrate-youtube-iframe-api-in-reactjs-solution\nclass Party extends React.Component {\n  state = {\n    user_name: \"\",\n    youtube_video_id: \"\",\n    youtube_current_pos: 0,\n    peer_id: \"\",\n    is_host: false,\n    chat_log: [],\n    invite_popup_shown: false,\n    connected_users: {},\n    color_code: \"\",\n    isStateChangeFromBroadcastData: false,\n    player_state: false\n  };\n\n  constructor(props) {\n    super(props);\n    window.global_this_obj = this;\n    window.peer_ids = [];\n    window.connections = [];\n  }\n\n  componentDidMount() {\n    const data = get_data(this.props.match.params.host_id);\n    const color_code = getRandomTagColor();\n    // i.e if host\n    if (data) {\n      if (!window.peer_obj) {\n        createConnection(this, true, null, this.props.match.params.host_id);\n      }\n\n      if (!data.connected_users) {\n        var connected_users = {};\n        connected_users[this.props.match.params.host_id] = {\n          user_name: data.user_name,\n          color_code: color_code,\n          is_host: true\n        };\n      } else {\n        var connected_users = data.connected_users;\n        // https://stackoverflow.com/questions/38416020/deep-copy-in-es6-using-the-spread-syntax\n        var reconnect_users = JSON.parse(JSON.stringify(connected_users));\n\n        delete reconnect_users[this.props.match.params.host_id];\n        bulk_connect(\n          Object.keys(reconnect_users),\n          connected_users[this.props.match.params.host_id]\n        );\n      }\n\n      this.setState({\n        peer_id: this.props.match.params.host_id,\n        user_name: data.user_name,\n        youtube_video_id: data.youtube_video_id,\n        only_host_controls: data.only_host_controls,\n        is_host: data.is_host,\n        connected_users: connected_users,\n        color_code: color_code\n      });\n    } else {\n      // Not a host: Create connection\n      createConnection(this, false, this.props.match.params.host_id);\n    }\n  }\n\n  setUserName = e => {\n    e.preventDefault();\n    const color_code = getRandomTagColor();\n    const connected_users = this.state.connected_users;\n    connected_users[this.state.peer_id] = {\n      user_name: e.target.user_name.value,\n      color_code: color_code,\n      is_host: false\n    };\n    this.setState({\n      user_name: e.target.user_name.value,\n      connected_users: connected_users,\n      color_code: color_code\n    });\n    introduce(e.target.user_name.value, color_code);\n  };\n\n  copyToClipboard = e => {\n    e.preventDefault();\n    this.copy_invite.select();\n    document.execCommand(\"copy\");\n    this.setState({ invite_popup_shown: true });\n  };\n\n  closeModal = e => {\n    this.setState({ invite_popup_shown: true });\n  };\n\n  notify = (message, timeout = 3000) => {\n    toast.info(message, {\n      position: \"bottom-left\",\n      autoClose: timeout,\n      hideProgressBar: false,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true,\n      progress: undefined,\n      toastId: message\n    });\n  };\n\n  render() {\n    return (\n      <div className=\"party-container\">\n        <ToastContainer\n          position=\"bottom-left\"\n          autoClose={3000}\n          hideProgressBar={false}\n          newestOnTop={false}\n          closeOnClick\n          rtl={false}\n          pauseOnFocusLoss={false}\n          draggable\n          pauseOnHover\n        />\n        <div\n          className={\n            \"modal   \" + (this.state.user_name === \"\" ? \"is-active\" : \"\")\n          }\n        >\n          <div className=\"modal-background\"></div>\n          <div className=\"modal-content\">\n            <div className=\"box\">\n              <form onSubmit={this.setUserName}>\n                <div className=\"field is-grouped\">\n                  <p className=\"control is-expanded\">\n                    <input\n                      className=\"input\"\n                      type=\"text\"\n                      name=\"user_name\"\n                      placeholder=\"Enter Your Username\"\n                      required\n                    />\n                  </p>\n                  <p className=\"control\">\n                    <button className=\"button is-primary\">Party</button>\n                  </p>\n                </div>\n              </form>\n            </div>\n          </div>\n          <button className=\"modal-close is-large\" aria-label=\"close\"></button>\n        </div>\n\n        <div className={\"modal \" + (this.state.invite_popup_shown ? \"is-active\" : \"\")}>\n          <div className=\"modal-background\" onClick={this.closeModal}></div>\n          <div className=\"modal-content\">\n            <div className=\"box\">\n              <form onSubmit={this.copyToClipboard}>\n                <label>Share this link with friends to watch YouTube together</label>\n\n                <div className=\"field is-grouped\">\n                  <p className=\"control is-expanded\">\n                    <input\n                      className=\"input\"\n                      type=\"text\"\n                      value={window.location.href}\n                      name=\"invite_link\"\n                      readOnly\n                      ref={copy_invite => (this.copy_invite = copy_invite)}\n                    />\n                  </p>\n                  <p className=\"control\">\n                    <button className=\"button is-primary\">\n                      <span role=\"img\" aria-label=\"cliboard_emoji\">\n                        ðŸ“‹\n                      </span>\n                      &nbsp;Copy Invite Link\n                    </button>\n                  </p>\n                </div>\n              </form>\n            </div>\n          </div>\n          <button\n            className=\"modal-close is-large\"\n            aria-label=\"close\"\n            onClick={this.closeModal}\n          />\n        </div>\n\n        <div>\n          <Player\n            youtube_video_id={this.state.youtube_video_id}\n            youtube_current_pos={this.state.youtube_current_pos}\n            is_host={this.state.is_host}\n            isStateChangeFromBroadcastData={\n              this.state.isStateChangeFromBroadcastData\n            }\n            player_state={this.state.player_state}\n          />\n          {(this.state.only_host_controls === false || this.state.is_host === true) && <ChangeVideo/>}\n        </div>\n        <ChatPanel\n          connected_users={this.state.connected_users}\n          only_host_controls={this.state.only_host_controls}\n          user_name={this.state.user_name}\n          chat_log={this.state.chat_log}\n          is_host={this.state.is_host}\n          color_code={this.state.color_code}\n        />\n      </div>\n    );\n  }\n}\nexport default Party;\n","import React, { useState } from \"react\";\nimport { Redirect } from \"react-router-dom\";\n\nconst Join = () => {\n  const [roomId, setRoomId] = useState('');\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setRoomId(e.target.roomId.value);\n  };\n\n  if (roomId !== '') {\n    return (\n      <Redirect\n        push\n        to={{\n          pathname: `party/${roomId}`,\n          state: { roomId }\n        }}\n      />\n    );\n  }\n  return (\n    <section className=\"section\">\n      <div className=\"container\">\n        <div className=\"columns is-centered\">\n          <div className=\"column is-half\">\n            <div className=\"card box\">\n              <div className=\"card-content\">\n                <form onSubmit={handleSubmit}>\n                  <div className=\"field\">\n                    <label className=\"label\">Room Id</label>\n                    <div className=\"control\">\n                      <input\n                        className=\"input\"\n                        placeholder=\"Paste the room Id here\"\n                        type=\"text\"\n                        name=\"roomId\"\n                        required\n                      ></input>\n                    </div>\n                  </div>\n                  <div className=\"buttons is-right\">\n                    <button className={\"button is-primary\"}>\n                      Party\n                    </button>\n                  </div>\n                </form>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default Join;\n","import React from \"react\";\n\nconst HomePage = () => (\n  <section className=\"hero is-primary has-background-primary is-fullheight\">\n    <div className=\"hero-body\">\n      <div className=\"tile is-ancestor\">\n        <div className=\"container homepage_left_hero\">\n          <h1 className=\"title has-text-centered not-selectable\">\n            Watch YouTube Together with Friends!\n          </h1>\n        </div>\n      </div>\n    </div>\n    <div className=\"row\">\n      <a className=\"select_column host\" href=\"#host\">\n        Host\n      </a>\n      <a className=\"select_column join\" href=\"#join\">\n        Join\n      </a>\n    </div>\n  </section>\n);\n\nexport default HomePage;\n","import React from \"react\";\nimport { HashRouter, Route, Switch } from \"react-router-dom\";\nimport Host from \"./Host\";\nimport Party from \"./Party\";\nimport Join from \"./Join\";\nimport HomePage from \"./HomePage\";\nconst Router = () => (\n  <HashRouter>\n    <Switch>\n      <Route exact path=\"/\" component={HomePage} />\n      <Route exact path=\"/host\" component={Host} />\n      <Route exact path=\"/join\" component={Join} />\n      <Route exact path=\"/party\" component={Host} />\n      <Route exact path=\"/party/:host_id\" component={Party} />\n    </Switch>\n  </HashRouter>\n);\nexport default Router;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./App.scss\";\nimport Router from \"./components/Router\";\nimport * as serviceWorker from \"./serviceWorker\";\nReactDOM.render(\n  <React.StrictMode>\n    <Router />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}